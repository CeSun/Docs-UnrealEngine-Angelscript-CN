+++
title = "Script Tests"
weight = 200
sort_by = "weight"
+++

# Angelscript Test Support
Angelscript features a xUnit-style unit testing framework. There is also an
integration test framework that can play back game scenarios and wait for
some condition to occur. You can generate code coverage reports for test
runs as well. `FName`

# Unit Tests
<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">Test_NameOfTheTestCase</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">FUnitTest</span><span style="color: #d4d4d4;">&amp; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #6a9955;">// Fails the test.</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AssertTrue</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">false</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AssertEquals</span><span style="color: #d4d4d4;">(</span><span style="color: #b5cea8;">1</span><span style="color: #d4d4d4;">, </span><span style="color: #b5cea8;">1</span><span style="color: #d4d4d4;"> + </span><span style="color: #b5cea8;">1</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AssertNotNull</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">nullptr</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">}</span></div></div>

You can put test code in any Angelscript file, but by convention these
are put in File_Test.as if your production code is in File.as.

## Running Unit Tests
Unit tests run on hot reload, so to run a test you just create a test like
above, open the Unreal editor, and save the file. In Unreal, go
Window > Developer Tools > Output Log and you will see lines like

```
Angelscript: [RUN]    Some.Angelscript.Subdir.Test_LaunchesNukesWhenCodesAreEntered
...
Angelscript: [OK]     Some.Angelscript.Subdir.Test_LaunchesNukesWhenCodesAreEntered (0.2530 ms)
```

Furthermore, the tests show up under the category "Angelscript" in the Test Automation tool.
You will need to install that one into Unreal. See [https://docs.unrealengine.com/en-US/Programming/Automation/UserGuide/index.html](https://docs.unrealengine.com/en-US/Programming/Automation/UserGuide/index.html)

You can also run tests from the command line:
```
Engine\Binaries\Win64\UE4Editor-Cmd.exe \Path\To\your.uproject -NullRHI -NoSound -NoSplash -ExecCmds="Automation RunTests Angelscript.UnitTests" -TestExit "Automation Test Queue Empty+Found 0 Automation Tests, based on" -unattended -stdout -as-exit-on-error
```

## Installing a Custom Game Mode for Unit Tests
You can add this line to one of your .ini files in your project to get a game mode in your tests:
You can then create a blueprint at the specified location and put whatever settings you want in there.
This will be used by all unit tests.

```ini
[/Script/EngineSettings.GameMapsSettings]
...
+GameModeClassAliases=(Name="UnitTest",GameMode="/Game/Testing/UnitTest/BP_UnitTestGameMode.BP_UnitTestGameMode_C")
```

# Integration Tests
Each integration test has a map where you can draw up any geometry or place any actors you like.

Add this to for instance MyTestName_IntegrationTest.as:

<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">IntegrationTest_MyTestName</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">FIntegrationTest</span><span style="color: #d4d4d4;">&amp; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{ &#160; </span></div><div><span style="color: #d4d4d4;">}</span></div></div>

Then you need to add a test map IntegrationTest_MyTestName.umap to /Content/Testing/ (create the dir if you don't have it
in your project yet). The map name is always the same as the test name, with .umap added.

You can also configure the integration test map dir with this setting in your .ini files:

```ini
[/Script/AngelscriptCode.AngelscriptTestSettings]
IntegrationTestMapRoot=/Game/Testing/
```

You can retrieve placed actors like this (or spawn them in the test):

<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #6a9955;">// Looks up an actor in the map</span></div><div><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">GetActorByLabel</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">UClass</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Class</span><span style="color: #d4d4d4;">, </span><span style="color: #569cd6;">const</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">FName</span><span style="color: #d4d4d4;">&amp; </span><span style="color: #9cdcfe;">Label</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #569cd6;">#if EDITOR</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">TArray</span><span style="color: #d4d4d4;">&lt;</span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;">&gt; </span><span style="color: #9cdcfe;">Actors</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #dcdcaa;">GetAllActorsOfClass</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">Class</span><span style="color: #d4d4d4;">, </span><span style="color: #9cdcfe;">Actors</span><span style="color: #d4d4d4;">);</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">for</span><span style="color: #d4d4d4;"> (</span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Actor</span><span style="color: #d4d4d4;">: </span><span style="color: #9cdcfe;">Actors</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #569cd6;">if</span><span style="color: #d4d4d4;"> (</span><span style="color: #9cdcfe;">Actor</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetActorLabel</span><span style="color: #d4d4d4;">() == </span><span style="color: #9cdcfe;">Label</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style="color: #569cd6;">return</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Actor</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; }</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">FString</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">AllActorLabels</span><span style="color: #d4d4d4;"> = </span><span style="color: #ce9178;">""</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">for</span><span style="color: #d4d4d4;"> (</span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Actor</span><span style="color: #d4d4d4;">: </span><span style="color: #9cdcfe;">Actors</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #9cdcfe;">AllActorLabels</span><span style="color: #d4d4d4;"> += </span><span style="color: #ce9178;">"- "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">Actor</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetActorLabel</span><span style="color: #d4d4d4;">() + </span><span style="color: #ce9178;">"</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">"</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">if</span><span style="color: #d4d4d4;"> (</span><span style="color: #9cdcfe;">AllActorLabels</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">IsEmpty</span><span style="color: #d4d4d4;">())</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #dcdcaa;">Throw</span><span style="color: #d4d4d4;">(</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style="color: #ce9178;">"Did not find an actor with class "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">Class</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetName</span><span style="color: #d4d4d4;">() +</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style="color: #ce9178;">" and label "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">Label</span><span style="color: #d4d4d4;"> + </span><span style="color: #ce9178;">". In fact, there no actors in this level."</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">else</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #dcdcaa;">Throw</span><span style="color: #d4d4d4;">(</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style="color: #ce9178;">"Did not find an actor with class "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">Class</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetName</span><span style="color: #d4d4d4;">() +</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style="color: #ce9178;">" and label "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">Label</span><span style="color: #d4d4d4;"> + </span><span style="color: #ce9178;">". Found these actors:</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">"</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">AllActorLabels</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><div><span style="color: #569cd6;">#endif &#160;// EDITOR</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #dcdcaa;">Throw</span><span style="color: #d4d4d4;">(</span><span style="color: #ce9178;">"GetActorByLabel is only for testing, i.e. when in EDITOR mode."</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">return</span><span style="color: #d4d4d4;"> </span><span style="color: #569cd6;">nullptr</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">}</span></div></div>

## Latent Automation Commands
The code in the test function executes before the map is loaded and before the first frame executes. The test is not complete when the test function returns therefore, it has merely enqueued a series of *latent automation commands* ([Unreal documentation](https://docs.unrealengine.com/en-US/Programming/Automation/TechnicalGuide/index.html)). If we assume the test enqueues no latent commands of its own (like the one above), the test framework will enqueue the following actions (see IntegrationTest.cpp):

- FWaitForMapToLoadCommand()
- FEnsureWorldLoaded()
- FExitGameCommand()
- FReportFinished()
- FFreeTest()

These execute in sequence. Each action can take multiple engine frames to execute.

The test can enqueue latent commands of its own:

<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">IntegrationTest_AlienShootsRepeatedly</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">FIntegrationTest</span><span style="color: #d4d4d4;">&amp; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{ </span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">A</span><span style="color: #d4d4d4;"> = </span><span style="color: #dcdcaa;">GetActorByLabel</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;">::</span><span style="color: #dcdcaa;">StaticClass</span><span style="color: #d4d4d4;">(), n</span><span style="color: #ce9178;">"BulletSponge"</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Floor</span><span style="color: #d4d4d4;"> = </span><span style="color: #569cd6;">Cast</span><span style="color: #d4d4d4;">&lt;</span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;">&gt;(</span><span style="color: #9cdcfe;">A</span><span style="color: #d4d4d4;">);</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AddLatentAutomationCommand</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">UGetsShotXTimes</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">Floor</span><span style="color: #d4d4d4;">, </span><span style="color: #b5cea8;">2</span><span style="color: #d4d4d4;">));</span></div><div><span style="color: #d4d4d4;">}</span></div></div>

The action is enqueued using `T.AddLatentAutomationCommand`. The set of latent actions will now be:

- ...
- FEnsureWorldLoaded()
- UGetsShowXTimes()
- FExitGameCommand()
- ...

AddLatentAutomationCommand takes a `ULatentAutomationCommand`:

<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #4fc1ff;">UCLASS</span><span style="color: #d4d4d4;">()</span></div><div><span style="color: #569cd6;">class</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;"> : </span><span style="color: #4ec9b0;">AStaticMeshActor</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">int</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">NumTimesHit</span><span style="color: #d4d4d4;"> = </span><span style="color: #b5cea8;">0</span><span style="color: #d4d4d4;">;</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4fc1ff;">UFUNCTION</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">BlueprintOverride</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">BeginPlay</span><span style="color: #d4d4d4;">()</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #9cdcfe;">OnTakeAnyDamage</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AddUFunction</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">this</span><span style="color: #d4d4d4;">, n</span><span style="color: #ce9178;">"TakeAnyDamage"</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4fc1ff;">UFUNCTION</span><span style="color: #d4d4d4;">()</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">private</span><span style="color: #d4d4d4;"> </span><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">TakeAnyDamage</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">DamagedActor</span><span style="color: #d4d4d4;">, </span><span style="color: #569cd6;">float32</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Damage</span><span style="color: #d4d4d4;">, </span><span style="color: #569cd6;">const</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">UDamageType</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">DamageType</span><span style="color: #d4d4d4;">, </span><span style="color: #4ec9b0;">AController</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">InstigatedBy</span><span style="color: #d4d4d4;">, </span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">DamageCauser</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #9cdcfe;">NumTimesHit</span><span style="color: #d4d4d4;">++;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><div><span style="color: #d4d4d4;">}</span></div><br><div><span style="color: #569cd6;">class</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">UGetsShotXTimes</span><span style="color: #d4d4d4;"> : </span><span style="color: #4ec9b0;">ULatentAutomationCommand</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">private</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">private</span><span style="color: #d4d4d4;"> </span><span style="color: #569cd6;">int</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">ExpectedNumHits</span><span style="color: #d4d4d4;">;</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">UGetsShotXTimes</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">ABulletSponge</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Target</span><span style="color: #d4d4d4;">, </span><span style="color: #569cd6;">int</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">X</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;"> = </span><span style="color: #9cdcfe;">Target</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #9cdcfe;">ExpectedNumHits</span><span style="color: #d4d4d4;"> = </span><span style="color: #9cdcfe;">X</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4fc1ff;">UFUNCTION</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">BlueprintOverride</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #569cd6;">bool</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">Update</span><span style="color: #d4d4d4;">()</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #6a9955;">// Note: actors can get DestroyActor'd at any time, so fail nicely if that happens!</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #dcdcaa;">ensure</span><span style="color: #d4d4d4;">(</span><span style="color: #dcdcaa;">IsValid</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;">));</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #569cd6;">return</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;">.</span><span style="color: #9cdcfe;">NumTimesHit</span><span style="color: #d4d4d4;"> &gt; </span><span style="color: #9cdcfe;">ExpectedNumHits</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4fc1ff;">UFUNCTION</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">BlueprintOverride</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">FString</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">Describe</span><span style="color: #d4d4d4;">() </span><span style="color: #569cd6;">const</span></div><div><span style="color: #d4d4d4;">&#160; &#160; {</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; </span><span style="color: #569cd6;">return</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetPathName</span><span style="color: #d4d4d4;">() + </span><span style="color: #ce9178;">": bullet sponge got hit "</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">BulletSponge</span><span style="color: #d4d4d4;">.</span><span style="color: #9cdcfe;">NumTimesHit</span><span style="color: #d4d4d4;"> + </span><span style="color: #ce9178;">"/"</span><span style="color: #d4d4d4;"> + </span><span style="color: #9cdcfe;">ExpectedNumHits</span><span style="color: #d4d4d4;">;</span></div><div><span style="color: #d4d4d4;">&#160; &#160; }</span></div><div><span style="color: #d4d4d4;">}</span></div></div>

The game engine will keep ticking as long as Update returns false. This means you can wait on any condition you can think of. The default timeout is five seconds though, so you can't wait for too long.

You can specify `default bAllowTimeout = true` on a latent command to allow it to time out. This is useful if you want to test that something is *not* happening
(e.g. check actor doesn't move out of bounds during 5 seconds).

## Running Integration Tests
Integration tests don't run on hot reload like unit tests, so you need to invoke them through the Test Automation window in Unreal. They are run just like unit tests, see above.

To run integration tests from the command line, run the same line as for unit tests but replace Angelscript.UnitTests with Angelscript.IntegrationTests.

## Complex Integration Tests
You can also generate test cases dynamically:

<div class="code_block" style="color: #d4d4d4;background-color: #1e1e1e;font-family: 'Terminus (TTF) for Windows', Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;"><div><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">ComplexIntegrationTest_PotionsAreTooStrongForKnight_GetTests</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">TArray</span><span style="color: #d4d4d4;">&lt;</span><span style="color: #4ec9b0;">FString</span><span style="color: #d4d4d4;">&gt;&amp; </span><span style="color: #9cdcfe;">OutTestCommands</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160;</span><span style="color: #569cd6;">for</span><span style="color: #d4d4d4;"> (</span><span style="color: #4ec9b0;">APotion</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Potion</span><span style="color: #d4d4d4;">: </span><span style="color: #4ec9b0;">MyGame</span><span style="color: #d4d4d4;">::</span><span style="color: #dcdcaa;">GetPotionRegistry</span><span style="color: #d4d4d4;">().</span><span style="color: #dcdcaa;">GetAllPotions</span><span style="color: #d4d4d4;">())</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160;{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160; &#160; &#160;</span><span style="color: #9cdcfe;">OutTestCommands</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">Add</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">Potion</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetName</span><span style="color: #d4d4d4;">().</span><span style="color: #dcdcaa;">ToString</span><span style="color: #d4d4d4;">());</span></div><div><span style="color: #d4d4d4;">&#160; &#160; &#160;}</span></div><div><span style="color: #d4d4d4;">}</span></div><br><div><span style="color: #569cd6;">void</span><span style="color: #d4d4d4;"> </span><span style="color: #dcdcaa;">ComplexIntegrationTest_PotionsAreTooStrongForKnight</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">FIntegrationTest</span><span style="color: #d4d4d4;">&amp; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #d4d4d4;">{</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">FString</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">PotionName</span><span style="color: #d4d4d4;"> = </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">GetParam</span><span style="color: #d4d4d4;">();</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">APotion</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Potion</span><span style="color: #d4d4d4;"> = </span><span style="color: #4ec9b0;">MyGame</span><span style="color: #d4d4d4;">::</span><span style="color: #dcdcaa;">GetPotionRegistry</span><span style="color: #d4d4d4;">().</span><span style="color: #dcdcaa;">LookupPotion</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">PotionName</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">AKnight</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">Knight</span><span style="color: #d4d4d4;"> = </span><span style="color: #569cd6;">Cast</span><span style="color: #d4d4d4;">&lt;</span><span style="color: #4ec9b0;">AKnight</span><span style="color: #d4d4d4;">&gt;(</span><span style="color: #dcdcaa;">GetActorByLabel</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">AKnight</span><span style="color: #d4d4d4;">::</span><span style="color: #dcdcaa;">StaticClass</span><span style="color: #d4d4d4;">(), n</span><span style="color: #ce9178;">"Knight"</span><span style="color: #d4d4d4;">));</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;"> </span><span style="color: #9cdcfe;">PotionSeller</span><span style="color: #d4d4d4;"> = </span><span style="color: #dcdcaa;">GetActorByLabel</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">AActor</span><span style="color: #d4d4d4;">::</span><span style="color: #dcdcaa;">StaticClass</span><span style="color: #d4d4d4;">(), n</span><span style="color: #ce9178;">"PotionSeller"</span><span style="color: #d4d4d4;">);</span></div><br><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #6a9955;">// Order the knight to walk over to the potion seller and try to buy a potion.</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">Knight</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">BuyPotionFrom</span><span style="color: #d4d4d4;">(</span><span style="color: #9cdcfe;">PotionSeller</span><span style="color: #d4d4d4;">, </span><span style="color: #9cdcfe;">Potion</span><span style="color: #d4d4d4;">);</span></div><div><span style="color: #d4d4d4;">&#160; &#160; </span><span style="color: #9cdcfe;">T</span><span style="color: #d4d4d4;">.</span><span style="color: #dcdcaa;">AddLatentAutomationCommand</span><span style="color: #d4d4d4;">(</span><span style="color: #4ec9b0;">UExpectResponse</span><span style="color: #d4d4d4;">(</span><span style="color: #ce9178;">"My potions are too strong for you traveller."</span><span style="color: #d4d4d4;">, </span><span style="color: #9cdcfe;">Knight</span><span style="color: #d4d4d4;">, </span><span style="color: #9cdcfe;">PotionSeller</span><span style="color: #d4d4d4;">));</span></div><div><span style="color: #d4d4d4;">}</span></div></div>

If we assume you have three potions in your potion registry, this generates three test cases:

```
Angelscript.IntegrationTest.Your.Path.ComplexIntegrationTest_PotionsAreTooStrongForKnight[DA_Potion1]
Angelscript.IntegrationTest.Your.Path.ComplexIntegrationTest_PotionsAreTooStrongForKnight[DA_Potion2]
Angelscript.IntegrationTest.Your.Path.ComplexIntegrationTest_PotionsAreTooStrongForKnight[DA_Potion3]
```

# Code Coverage
Enable code coverage in Project Settings > Editor > Angelscript Test settings (or pass -as-enable-code-coverage on the command line). Note, code coverage slows down editor startup by ~20 seconds so remember to turn it off later.

![CoverageToggle](/img/coverage-toggle.png)

Run some tests as described above. The editor will write a report to Saved/CodeCoverage. Note: it's overwritten each time you start a new test run.

![CoverageDir](/img/coverage-dir.png)

Open index.html to see a summary for all your angelscript.

![CoverageIndex](/img/coverage-index.png)

Open individual files to see their line coverage.

![CoverageDir](/img/coverage-file.png)